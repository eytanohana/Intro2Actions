name: uv release tools

on:
  pull_request:
    branches: [ "main" ]
    types: [opened, synchronize, labeled, unlabeled, closed]

jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: read

    steps:
      - name: Check out Repo Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Validate labels or create release
        id: action
        uses: eytanohana/uv-release-tools@main
        with:
          tag_prefix: "version_"

        # Action auto-detects context:
        # - PR open/update → validates labels
        # - PR merged → bumps version and creates tag

      - name: Check outputs
        run: |
          echo "valid: ${{ steps.action.outputs.valid }}"
          echo "release_type: ${{ steps.action.outputs.release_type }}"
          echo "version: ${{ steps.action.outputs.version }}"
          echo "previous_version: ${{ steps.action.outputs.previous_version }}"
          echo "tag: ${{ steps.action.outputs.tag }}"
          echo "created_tag: ${{ steps.action.outputs.created_tag }}"
          echo "committed: ${{ steps.action.outputs.committed }}"
